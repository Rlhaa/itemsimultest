# ItemSimulator Project

# 개발 기간

- 24/11/25~24/11/28 (4일)

# 코드 구조

서버 설정 (app.js)

- Express 애플리케이션을 생성
- 환경 변수를 로드하여 서버를 설정
- 다양한 API 라우터를 /api 경로에 연결하여 회원가입, 로그인, 캐릭터, 삭제, 검색, 아이템 관련 기능 제공
- 지정된 포트(3000)에서 서버를 실행합니다.

Prisma 스키마
Item, Accounts, Characters, Character_Inventory, Character_Items의 다섯 가지 모델 정의

- Item : 아이템의 고유 ID, 코드, 이름, 스탯, 가격, 캐릭터 인벤토리와 아이템 간의 관계 설정
- Accounts: 계정 정보, 이메일, 아이디, 비밀번호, 이름, 나이, 성별, 생성일시
- Characters : 고유 ID, 계정 ID, 닉네임, 체력, 공격력, 돈, 생성일자, 계정과의 관계를 설정
- Character_Inventory : 캐릭터의 인벤토리 정보, 아이템 ID, 수량
- Character_Items : 소지아이템, 착용여부
- 외래키 관계를 통해 서로 연결되어 있으며, Cascade 삭제 옵션 설정

API

- 아이템 생성, 수정, 목록 조회, 특정 아이템 조회와 관련된 API
- 회원가입, 로그인, 캐릭터, 삭제, 검색 관련 API
- 각각의 기능에 맞는 라우터로 구현
- app.js에서 /api 경로에 연결

인증 미들웨어 (authM.js)

- 요청 헤더에서 authorization 정보를 추출하여 Bearer 토큰 형식을 확인하고, 유효하지 않으면 에러 반환
- JWT를 검증하여 사용자 정보를 추출, 데이터베이스에서 해당 사용자 계정을 조회하여 존재하지 않으면 에러 반환
- 인증이 성공하면 인증된 사용자 정보를 req.abc에 저장 후 다음단계로 진행

# 개발 환경

IDE: Visual Studio Code (VSCode)
서버: Amazon EC2 인스턴스
데이터베이스: Amazon RDS
API 테스트 도구: Insomnia
버전 관리: GitHub

# 사용 라이브러리

@prisma/client: 데이터베이스와의 상호작용을 위한 Prisma 클라이언트
bcrypt: 비밀번호 해싱을 위한 라이브러리
cookie-parser: 쿠키 파싱을 위한 미들웨어
dotenv: 환경 변수를 관리하기 위한 라이브러리
express: 웹 서버 프레임워크
jsonwebtoken: JWT 토큰 생성을 위한 라이브러리
prisma: Prisma ORM
nodemon: 개발 중 자동으로 서버를 재시작하기 위한 도구

# 핵심기능

사용자 회원가입 및 로그인
로그인 시 발행되는 토큰을 통해 인증 및 인가 진행
사용자 개인 계정에 귀속되는 캐릭터 생성, 조회, 삭제 기능
아이템 생성, 수정, 조회, 삭제 기능

1. **암호화 방식**

   - 비밀번호를 DB에 저장할 때 Hash를 이용했는데, Hash는 단방향 암호화와 양방향 암호화 중 어떤 암호화 방식에 해당할까요?
     Hash 암호화는 원본 데이터를 다른 데이터로 변환하며 해시된 값을 원래의 비밀번호로 복원할 수 없기 때문에 단방향 암호화
     방식에 해당된다.

   - 비밀번호를 그냥 저장하지 않고 Hash 한 값을 저장 했을 때의 좋은 점은 무엇인가요?
     비밀번호 원본이 아닌 함호화된 데이터를 사용하기 때문에 db가 유출되어도 비밀번호를 알 수 없다.

2. **인증 방식**

   - JWT(Json Web Token)을 이용해 인증 기능을 했는데, 만약 Access Token이 노출되었을 경우 발생할 수 있는 문제점은 무엇일까요?
     인증 시 필요한 정보가 담긴 토큰이기 때문에, 유출에 취약하다.

   - 해당 문제점을 보완하기 위한 방법으로는 어떤 것이 있을까요?
     토큰의 유효기간을 짧게 설정한다.
     Access Token과 함께 Refresh Token을 사용하여 Access Token이 만료되면 Refresh Token으로 새로운 Access Token을 발급받도록 한다.

3. **인증과 인가**

   - 인증과 인가가 무엇인지 각각 설명해 주세요.
     인증 : 사용자가 자신이 누구인지 확인하는 과정 ex) 로그인
     인가 : 사용자가 인증된 후, 특정 기능, 자원등에 접근할 수 있는 권한을 부여하는 것

   - 위 API 구현 명세에서 인증을 필요로 하는 API와 그렇지 않은 API의 차이가 뭐라고 생각하시나요?
     사용자의 신원이 확인되어야만 사용되는 API들은 개인의 소유로 취급될 수 있는 부분때문에 인증 과정이 필요한것 같고,
     인증이 필요하지 않은 API들은 공개적인 정보로 취급될 수 있는 부분이 차이라고 생각된다.

   - 아이템 생성, 수정 API는 인증을 필요로 하지 않는다고 했지만 사실은 어느 API보다도 인증이 필요한 API입니다. 왜 그럴까요?
     아이템은 플레이어 개인의 소유로 취급될 수 있고, 누구나 접근이 가능하다면 이를 타인이 악의적인 의도를 가지고 변형시킬 수 있기 때문에 인증 과정을 통해 소유자임을 증명하는 과정이 꼭 필요할 것이다.

4. **Http Status Code**

   - 과제를 진행하면서 사용한 Http Status Code를 모두 나열하고, 각각이 의미하는 것과 어떤 상황에 사용했는지 작성해 주세요.
     200 : 요청이 성공적으로 처리되었을 때를 나타낸다. > 조회, 로그인등의 요청 성공시
     201 : 요청이 성공적으로 처리되어 새로운 리소스가 생성되었음을 나타낸다. > 회원가입, 캐릭터 생성등의 요청 성공 시
     401 : 인증이 필요하거나 실패했은을 나타낸다. > 토큰 만료, 조작 시, id나 password 오기입 등 인증 실패 시
     404 : 요청한 정보를 찾을 수 없음을 나타낸다. > 존재하지 않는 캐릭터, 아이템등을 조회 요청하였을 때
     409 : 요청이 현재 서버의 상태와 충돌할 때를 나타낸다. > 정해진 양식에서 벗어난 아이디, 비밀번호 기입 시

5. **게임 경제**

   - 현재는 간편한 구현을 위해 캐릭터 테이블에 money라는 게임 머니 컬럼만 추가하였습니다.

     - 이렇게 되었을 때 어떠한 단점이 있을 수 있을까요?
       다른 종류의 재화가 추가된다면 단일 컬럼만으로는 관리가 어려울 수 있다.

     - 이렇게 하지 않고 다르게 구현할 수 있는 방법은 어떤 것이 있을까요?
       재화 테이블을 따로 구성하여 다양한 종류의 재화를 관리할 수 있다.

   - 아이템 구입 시에 가격을 클라이언트에서 입력하게 하면 어떠한 문제점이 있을 수 있을까요?
     사용자가 구입 가격을 직접 수정하여 구입이 가능한 순간 게임내 재화는 의미가 없어진다고 생각한다.

6. 어려웠던 점

- 이전 프로젝트와 달리 스켈레톤 코드같은 기본 틀이 없어 초반 폴더, 파일, 코드 구성 자체가 어려웠다.
- 강의 내용을 기반으로 진행하던 중 다른 db가 사용되어 내가 사용하는 환경에 맞게 변형하는 것이 어려웠다.
- 강의만으로 개념적인 내용을 모두 이해할 수는 없었기 때문에 프로젝트를 직접 진행하며 배우는 것이 더 많았다.
- 인증을 위한 토큰 개념과 적용에 가장 많은 시간을 할애했을 정도로 이해, 실습에 어려움이 있어 도움 없이는 구현이 힘들었을 것 같다.
- 도전 기능을 시도하였지만 인증이 실패해도 API가 실행될 수 있도록 전체적인 수정이 필요하였고, 이 과정에서 복잡도가 올라가 에러 없이 구현하기가 어려웠다.
